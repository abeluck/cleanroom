Problem: When the RAM disk is full, Tails fails to shutdown correctly and wipe the memory when the boot device is unplugged.

Reproduction: I encountered the problem with SD flash cards and it probably also happens with normal USB sticks. Boot Tails from the USB stick, create a huge file (cat /dev/zero > /home/amnesia/test.dat) and unplug the stick when cat is finished.

Symptoms: Tails either stays in graphical mode, does not shut down at all and does not allow the user to run any program, or it shuts down X but hangs itself up in console mode, printing 'Unable to read page, block entry ....' or 'Unable to read data cache entry' nonstop. After a hard reboot, an adversary can copy the RAM contents of the previous Tails session (normal boot attack).

Probable reason: Virtual filesystem does not keep neccessary files in memory.

Probable solution: Force squashfs to keep certain files, especially the shutdown scripts and the files required for kexec, in memory.

--JohnDoe
