[[!tag todo/research todo/code]]

[[!toc levels=3]]

iceweasel
=========

## default profile in `/etc/iceweasel/` rather than in `$HOME`

* system-wide preferences can be set in `/etc/iceweasel/pref/iceweasel.js`
* `/etc/iceweasel/profile/` contains a profile skeleton that is copied
  into newly created user profiles.

### pros

* some files seem easier to configure there, e.g.
  `/etc/iceweasel/profile/bookmarks.html`
* no need to resync `$HOME` every time a Debian packaged extension is
  upgraded, in order to avoid the annoying "an extension has been
  upgraded" dialog box
* forces us to configure iceweasel in a fully programmatic way

### cons

### to check

* were do we put extensions that aren't Debian-packaged?

## NSS *.db files

* `cert8.db`: could be generated from scratch by adding our few custom
  SSL root certificates with `certutil`
* `secmod.db`: if this file is missing, a new one is generated without
  DSA, SHA256 and SHA512; weird.
* `key3.db`: if missing, the other `*.db` files can't be used

## sqlite

We now have the needed code to generate sqlite files at boot time from
plain SQL files dropped into
`config/chroot_local-includes/usr/share/amnesia/iceweasel/sql/`.

### left to do

We still ship one binary sqlite file, which is `places.sqlite`.
Our custom bookmarks are the only pieces of data we want to preserve
in there.

* if we don't use `/etc/iceweasel/profile/`: according to
  [MozillaZine](http://kb.mozillazine.org/Places.sqlite), a missing
  `places.sqlite` is rebuilt using the latest dated JSON file from the
  `bookmarkbackups` folder. We could then store our bookmarks data as
  a backup, and rm+exclude `places.sqlite`.
* if we use `/etc/iceweasel/profile/`, we can drop a `bookmarks.html`
  file there and get rid of `places.sql`

## resources

- [TBB's build
  scripts](https://svn.torproject.org/svn/torbrowser/trunk/build-scripts/)
  do a bunch of things that can be very interesting for us

Gnome
=====

We already configure GNOME via XML files dropped into
`config/chroot_local-includes/usr/share/amnesia/gconf/`, that are
loaded at boot time.

[Sabayon](http://live.gnome.org/Sabayon/) is "a system administration
tool to define and deploy desktop profiles for the GNOME
desktop environment." It may very well be fit our needs, but
it is currently (20100213) only available in Debian experimental
(which is explained by [[!debbug 534941]]).
